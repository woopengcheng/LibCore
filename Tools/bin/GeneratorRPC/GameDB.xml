<?xml version="1.0" encoding="UTF-8"?>


<!--
	使用方法:RPCMsgs包含了所有的RPC的消息.
		DefaultParams:
			目的是为了方便,如果不给类型加参数的话,系统会默认增加参数.
			如果需要增加新的类型.这个新类型需要包含默认参数.默认参数需要在<DefaultParams />中声明类型和值.类型只能为1个单字.不能出现const char * 或者Msg::Chunk这种.
		
		RpcServerName:指的是作为RPC服务器的功能.
			serverName: 
				指的是当前服务器的功能.主要分为,client发起端,server接收端,proxy代理转发端.
				serverName不可更改.不然无法解析.
			serverInclude: 
				需要包含的继承自RPCInterface的class的头文件包含路径.
			namespace:
				指的是当前RPC服务器所使用的命名空间
			rpcInterface:
				指的是当前RPC服务器继承自RPCInterface的接口.
			outputPath: 
				当前的RPC服务器输出的文件地方.注意末尾加/
			
		RpcNamespace:
			Rpc要转发的服务器列表.需要给出服务器列表的名字和路径.这也是RPC的生成路径.
		RPCS:
			这里是所有的RPC对于RPC而言可以传递声明的参数类型也可以传递RpcData.RpcData的参数类型需要在默认参数中声明.且需要名字就可以了.
			RpcData:
				定义一个结构体,用于传递消息时,大家可以共用一份.
			Rpc:
				对于一个Rpc而言.需要知道这个Rpc的名字.在哪个类里面使用.客户端(远程调用)名字.服务器名字.代理服务器名字.代理服务器没有则为空.但必须有客户端和服务器.
				name:
					RPC名字
				serverClass:
					当前RPC所属于的类
				serverInclude:
					此RPC属于的头文件.
				支持的服务器类型,必须和上面登记的一样.
					client="Client" proxy="Proxy" server="Server"
				syncType:
					0代表同步.1代表异步,
			call和Return:
				call为一个RPC的发起调用.或者超时时调用的函数.return为RPC从服务器返回的多个值.
		
-->


<RpcMsgs>	
	<!--
		以下为基本类型,在Parameter中含有的.也可以在代码中定义,不过需要的是只能为一个单词.当然也可以自定义rpcdata
	-->		
	<DefaultParams SINT8='0'  UINT8='0'/>
	<DefaultParams INT16='0' UINT16='0'/>
	<DefaultParams INT32='0' UINT32='0'/>
	<DefaultParams INT64='0' UINT64='0'/> 
	<DefaultParams double='0.0f' float='0.0f'/> 
	<DefaultParams std_string='std::string()'/> 
	<DefaultParams LibCore_Chunk='LibCore::Chunk()'/>

	<RpcServerName serverName="Server" include="DBServer.h" namespace="Server" rpcInterface="DBServer" outputPath="../../../Tools/src/GameDBServer/src/rpc/"/>
	<RpcServerName serverName="Client" include="DBClient.h" namespace="Client" rpcInterface="DBClient" outputPath="../../../Tools/src/GameDBClient/src/rpc/"/>
	<RpcServerName serverName="Master" include="DBMaster.h" namespace="Server" rpcInterface="DBMaster" outputPath="../../../Tools/src/GameDBServer/src/rpc/"/>
	<RpcServerName serverName="Slave" include="DBSlave.h" namespace="Server" rpcInterface="DBSlave" outputPath="../../../Tools/src/GameDBServer/src/rpc/"/> 
	
	<Rpcs>  
		<RpcData name="UserLogin">
			<Param type="SINT8" name="userid1" default="0"/>
			<Param type="UINT8" name="localid2" default="0"/> 
			<Param type="INT16" name="userid3" default="0"/>
			<Param type="UINT16" name="localid4" default="0"/>  
			<Param type="INT32" name="localid6" default="0"/> 
			<Param type="UINT32" name="userid7" default="0"/>
			<Param type="INT64" name="localid8" default="0"/> 
			<Param type="UINT64" name="userid9" default="0"/>
			<Param type="double" name="localid10" default="1.0f"/> 
			<Param type="float" name="localid11" default="1.0f"/> 
			<Param type="std_string" name="localid12" /> 
			<Param type="LibCore_Chunk" name="localid13" /> 
		</RpcData>

		<!--		
		databse处理rpc
		-->
		<Rpc name="HandleUserAuth" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call > 
				<Param name="name" type="std_string" default=""/>
				<Param name="pwd" type="std_string" default=""/>
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleSelectDatabase" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call > 
				<Param name="dbname" type="std_string" default=""/>
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleCreateDatabase" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call > 
				<Param name="dbname" type="std_string" default=""/>
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleDeleteDatabase" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call > 
				<Param name="dbname" type="std_string" default=""/>
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 		
		
		<Rpc name="HandleShowDatabases" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call > 
			</Call>

			<Return>
				<Param name="res" type="LibCore_Chunk" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleCreateUser" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call > 
				<Param name="name" type="std_string" default=""/>
				<Param name="pwd" type="std_string" default=""/>
				<Param name="issys" type="SINT8" default="0"/>
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleDeleteUser" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call > 
				<Param name="name" type="std_string" default=""/>
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleModifyUser" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call > 
				<Param name="name" type="std_string" default=""/> 
				<Param name="pwd" type="std_string" default=""/>
				<Param name="issys" type="SINT8" default="0"/>
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
			
		
		<!--
		hashtable处理rpc
		-->
		<Rpc name="HandleHSet" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="key" type="std_string" default=""/>
				<Param name="value" type="std_string" default=""/>
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHSetNX" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="key" type="std_string" default=""/>
				<Param name="value" type="std_string" default=""/>
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHSetOW" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="key" type="std_string" default=""/>
				<Param name="value" type="std_string" default=""/>
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHGet" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="key" type="std_string" default=""/>
			</Call>

			<Return> 
				<Param name="value" type="std_string" default=""/>
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHDel" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="key" type="std_string" default=""/> 
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHSetIncr" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="key" type="std_string" default=""/>
				<Param name="value" type="INT64" default=""/>
			</Call>

			<Return>
				<Param name="res" type="INT64" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHSetIncrFloat" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="key" type="std_string" default=""/>
				<Param name="value" type="double" default=""/>
			</Call>

			<Return>
				<Param name="res" type="double" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHGetKeys" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/> 
			</Call>

			<Return>
				<Param name="res" type="LibCore_Chunk" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHGetVals" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/> 
			</Call>

			<Return>
				<Param name="res" type="LibCore_Chunk" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHGetKeyVals" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/> 
			</Call>

			<Return>
				<Param name="res" type="LibCore_Chunk" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHScan" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/> 
				<Param name="start" type="std_string" default=""/> 
				<Param name="regexp" type="std_string" default=""/> 
				<Param name="limit" type="INT64" default="10"/>  
			</Call>

			<Return>
				<Param name="res" type="LibCore_Chunk" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHCount" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>  
			</Call>

			<Return>
				<Param name="res" type="INT64" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHDrop" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>  
			</Call>

			<Return>
				<Param name="res" type="INT64" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHList" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call > 
			</Call>

			<Return>
				<Param name="res" type="LibCore_Chunk" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHMultiSet" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="keyvalues" type="LibCore_Chunk" default=""/> 
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHMultiGet" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="keys" type="LibCore_Chunk" default=""/> 
			</Call>

			<Return>
				<Param name="res" type="LibCore_Chunk" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleHMultiDel" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="keys" type="LibCore_Chunk" default=""/> 
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<!--
		sortedset处理rpc
		-->
		<Rpc name="HandleZSet" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="key" type="std_string" default=""/>
				<Param name="score" type="INT64" default=""/>
			</Call>

			<Return>
				<Param name="resCode" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleZGet" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="key" type="std_string" default=""/>
			</Call>

			<Return> 
				<Param name="score" type="INT64" default="0"/>
			</Return>
		</Rpc> 
		
		<Rpc name="HandleZDel" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="key" type="std_string" default=""/>
			</Call>

			<Return> 
				<Param name="score" type="INT64" default="0"/>
			</Return>
		</Rpc> 
		
		<Rpc name="HandleZTop" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="start" type="INT64" default="0"/> 
				<Param name="end" type="INT64" default="0"/> 
				<Param name="limit" type="INT64" default="0"/> 
			</Call>

			<Return>
				<Param name="res" type="LibCore_Chunk" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleZRTop" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>
				<Param name="start" type="INT64" default="0"/> 
				<Param name="end" type="INT64" default="0"/> 
				<Param name="limit" type="INT64" default="0"/> 
			</Call>

			<Return>
				<Param name="res" type="LibCore_Chunk" /> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleZDrop" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/> 
			</Call>

			<Return>
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleZCount" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
				<Param name="table" type="std_string" default=""/>  
			</Call>

			<Return>
				<Param name="res" type="INT64" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleZList" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call > 
			</Call>

			<Return>
				<Param name="res" type="LibCore_Chunk" default=""/> 
			</Return>
		</Rpc> 
		
		<Rpc name="HandleDump" serverInclude="ServerHandler.h" serverClass="ServerHandler" client="Client" server="Server" syncType="0" timeout="10">
			<Call >
			</Call>

			<Return>
				<Param name="res" type="LibCore_Chunk" default=""/> 
			</Return>
		</Rpc> 
		
		<!--
		slave相关rpc
		-->
		<Rpc name="SyncMasterHandler" serverInclude="SlaveHandler.h" serverClass="SlaveHandler" client="Master" server="Slave" syncType="1" timeout="10">
			<Call > 
				<Param name="id" type="INT32"/>
			</Call>

			<Return>  
				<Param name="res" type="INT32" /> 
			</Return>
		</Rpc>
		
		<Rpc name="SlaveStartAuth" serverInclude="ServerHandler.h" serverClass="ServerHandler" proxyInclude="MasterHandler.h" proxyClass="MasterHandler" clientInclude="SlaveHandler.h" clientClass="SlaveHandler" client="Slave" proxy="Master" server="Server" syncType="1" timeout="10">
			<Call > 
				<Param name="name" type="std_string" default=""/>
				<Param name="pwd" type="std_string" default=""/>
			</Call>

			<Return>  
				<Param name="value" type="std_string" default=""/> 
			</Return>
		</Rpc>
		
		<Rpc name="SlaveSelectDB" serverInclude="MasterHandler.h" serverClass="MasterHandler" clientInclude="SlaveHandler.h" clientClass="SlaveHandler" client="Slave" server="Master" syncType="1" timeout="10">
			<Call > 
				<Param name="dbname" type="std_string" default=""/> 
			</Call>

			<Return>  
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc>
		
		<Rpc name="SlaveRequestSync" serverInclude="ServerHandler.h" serverClass="ServerHandler" proxyInclude="MasterHandler.h" proxyClass="MasterHandler" clientInclude="SlaveHandler.h" clientClass="SlaveHandler" client="Slave" proxy="Master" server="Server" syncType="1" timeout="3600">
			<Call >
				<Param name="dbname" type="std_string" default=""/> 
			</Call>

			<Return> 
				<Param name="newbackdir" type="std_string" default=""/>  
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc>
		
		<Rpc name="MasterStartSync" serverInclude="SlaveHandler.h" serverClass="SlaveHandler" client="Master" server="Slave" syncType="1" timeout="10">
			<Call > 
				<Param name="filename" type="std_string"/>
				<Param name="filesize" type="INT32"/>
				<Param name="sendtype" type="INT32"/>
				<Param name="value" type="LibCore_Chunk"/>
			</Call>

			<Return>  
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc>
		
		<Rpc name="SyncDataToSlave" serverInclude="SlaveHandler.h" serverClass="SlaveHandler" clientInclude="ServerHandler.h" clientClass="ServerHandler" client="Server" proxy="Master" server="Slave" syncType="1" timeout="10">
			<Call > 
				<Param name="dbname" type="std_string"/>
				<Param name="value" type="LibCore_Chunk"/>
			</Call>

			<Return>  
				<Param name="res" type="INT32" default="0"/> 
			</Return>
		</Rpc>
		
		<Rpc name="testRefers" serverInclude="SlaveHandler.h" serverClass="SlaveHandler" proxyInclude="MasterHandler.h" proxyClass="MasterHandler" clientInclude="SlaveHandler.h" clientClass="SlaveHandler" client="Server" proxy="Master" server="Slave" syncType="1" timeout="10">
			<Call > 
				<Param name="dbname" type="std_string" refer=""/>
				<Param name="value" type="LibCore_Chunk"/> 
			</Call>

			<Return>  
				<Param name="res" type="LibCore_Chunk" refer=""/> 
			</Return>
		</Rpc>
		
		<Rpc name="testTheSameNode" serverInclude="MasterHandler.h" serverClass="MasterHandler" clientInclude="ServerHandler.h" clientClass="ServerHandler" client="Server" server="Master" syncType="1" timeout="10">
			<Call > 
				<Param name="dbname" type="std_string" refer=""/>
				<Param name="value" type="LibCore_Chunk"/> 
			</Call>

			<Return>  
				<Param name="res" type="LibCore_Chunk" refer=""/> 
			</Return>
		</Rpc>
	</Rpcs>
	 
</RpcMsgs>
