#include "Marshal/inc/CStream.h"
#include "UnitTest++/UnitTestPP.h"


TEST(CStream_SINT8)
{
	CUtil::CStream cs;
	SINT8 p1 = 0x00000000;
	SINT8 p2 = 0x0000000F;
	SINT8 p3 = 0x00000010;  
	SINT8 p4 = 0x0000007F; 
	SINT8 p5 = -0x00000000; 
	SINT8 p6 = -0x0000000F; 
	SINT8 p7 = -0x0000007F; 

	SINT8 q1 = 0;
	SINT8 q2 = 0;
	SINT8 q3 = 0;
	SINT8 q4 = 0; 
	SINT8 q5 = 0;
	SINT8 q6 = 0; 
	SINT8 q7 = 0; 
	cs << p1 << p2 << p3 << p4 << p5 << p6 << p7;
	cs >> q1 >> q2 >> q3 >> q4 >> q5 >> q6 >> q7;

	CHECK_EQUAL(p1 , q1); 
	CHECK_EQUAL(p2 , q2); 
	CHECK_EQUAL(p3 , q3);
	CHECK_EQUAL(p4 , q4);  
	CHECK_EQUAL(p5 , q5); 
	CHECK_EQUAL(p6 , q6); 
	CHECK_EQUAL(p7 , q7); 
} 

TEST(CStream_UINT8)
{
	CUtil::CStream cs;
	UINT8 p1 = 0x00000000;
	UINT8 p2 = 0x0000000F;
	UINT8 p3 = 0x00000010;
	UINT8 p4 = 0x0000007F; 
	UINT8 p5 = 0x00000080; 
	UINT8 p6 = 0x0000008F; 
	UINT8 p7 = 0x000000FF; 

	UINT8 q1 = 0;
	UINT8 q2 = 0;
	UINT8 q3 = 0;
	UINT8 q4 = 0; 
	UINT8 q5 = 0;
	UINT8 q6 = 0; 
	UINT8 q7 = 0; 
	cs << p1 << p2 << p3 << p4 << p5 << p6 << p7;
	cs >> q1 >> q2 >> q3 >> q4 >> q5 >> q6 >> q7;

	CHECK_EQUAL(p1 , q1); 
	CHECK_EQUAL(p2 , q2); 
	CHECK_EQUAL(p3 , q3);
	CHECK_EQUAL(p4 , q4);  
	CHECK_EQUAL(p5 , q5); 
	CHECK_EQUAL(p6 , q6); 
	CHECK_EQUAL(p7 , q7); 
} 

TEST(CStream_INT16)
{
	CUtil::CStream cs;
	INT16 p[] = { 0x00000000, 0x0000000F, 0x00000010,	0x000000FF,
		0x00000100,	0x00000FFF,	0x00001000,	0x00007FFF,
		-0x00000000,-0x0000000F,-0x00000010,-0x000000FF,	
		-0x00000100,-0x00000FFF,-0x00007FFF };

	INT16 q[ARRAY_SIZE(p)];  
	for (UINT16 i = 0;i < ARRAY_SIZE(p);++i)
	{
		cs << p[i];
		cs >> q[i];

		CHECK_EQUAL(p[i] , q[i]); 
	}   
} 

TEST(CStream_UINT16)
{
	CUtil::CStream cs;
	UINT16 p[] = { 0x00000000, 0x0000000F, 0x00000010,	0x000000FF,
		0x00000100,	0x00000FFF,	0x00001000,	0x00007FFF,
		0x00008000,	0x0000800F,	0x00008010,	0x000080FF,	
		0x00008100,	0x00008FFF,	0x0000FFFF };

	UINT16 q[ARRAY_SIZE(p)];  
	for (UINT16 i = 0;i < ARRAY_SIZE(p);++i)
	{
		cs << p[i];
		cs >> q[i];

		CHECK_EQUAL(p[i] , q[i]); 
	}   
} 

TEST(CStream_INT32)
{
	CUtil::CStream cs;
	INT32 p[] = { 0x00000000, 0x0000000F, 0x00000010, 0x000000FF,
		0x00000100,	0x00000FFF,	0x00001000,	0x0000FFFFF,
		0x00010000,	0x00FFFFFF,	0x00100000,	0x0FFFFFFF,	
		0x10000000,	0x7FFFFFFF,	0xFFFFFFFF,	0x80000001,	
		0x8000000F,	0x80000010,	0x800000FF,	0x80000100,	
		0x80000FFF,	0x80001000,	0x800FFFFF,	0x80100000,
		0x80FFFFFF,	0x81000000,	0x8FFFFFFF,	0xFFFFFFFF};

	INT32 q[ARRAY_SIZE(p)] = {0};  

	for (INT32 i = 0;i < ARRAY_SIZE(p);++i)
	{
		cs << p[i];
		cs >> q[i];

		CHECK_EQUAL(p[i] , q[i]); 
	}   
}  

TEST(CStream_UINT32)
{
	CUtil::CStream cs;
	UINT32 p[] = { 0x00000000, 0x0000000F, 0x00000010, 0x000000FF,
		0x00000100,	0x00000FFF,	0x00001000,	0x0000FFFFF,
		0x00010000,	0x00FFFFFF,	0x00100000,	0x0FFFFFFF,	
		0x10000000,	0x7FFFFFFF,	0xFFFFFFFF,	0x80000001,	
		0x8000000F,	0x80000010,	0x800000FF,	0x80000100,	
		0x80000FFF,	0x80001000,	0x800FFFFF,	0x80100000,
		0x80FFFFFF,	0x81000000,	0x8FFFFFFF,	0xFFFFFFFF};

	UINT32 q[ARRAY_SIZE(p)] = {0};  

	for (INT32 i = 0;i < ARRAY_SIZE(p);++i)
	{
		cs << p[i];
		cs >> q[i];

		CHECK_EQUAL(p[i] , q[i]); 
	}   
} 

TEST(CStream_INT64)
{
	CUtil::CStream cs;
	INT64 p[] = { 0x0000000000000000 , 0x000000000000000F, 0x0000000000000010,	0x00000000000000FF,
	0x0000000000000100,	0x0000000000000FFF,	0x0000000000001000,	0x000000000000FFFFF,0x0000000000010000,
	0x0000000000FFFFFF,	0x0000000000100000,	0x000000000FFFFFFF,	0x0000000010000000,	0x00000000FFFFFFFF,
	0x0000000100000000, 0x0000000FFFFFFFFF, 0x0000001000000000,	0x000000FFFFFFFFFF,	0x0000010000000000,
	0x00000FFFFFFFFFFF,	0x0000100000000000,	0x0000FFFFFFFFFFFF,	0x0001000000000000,	0x000FFFFFFFFFFFFF,
	0x0010000000000000,	0x00FFFFFFFFFFFFFF,	0x0100000000000000,	0x0FFFFFFFFFFFFFFF,	0x1000000000000000,
	0x7FFFFFFFFFFFFFFF, 0x8000000000000001,	0x800000000000000F,	0x8000000000000010,	0x80000000000000FF,
	0x8000000000000100,	0x8000000000000FFF,	0x8000000000001000,	0x80000000000FFFFF,	0x8000000000100000,
	0x8000000000FFFFFF,	0x8000000001000000,	0x800000000FFFFFFF,	0x8000000010000000, 0x80000000FFFFFFFF,
	0x8000001000000000,	0x800000FFFFFFFFFF,	0x8000010000000000,	0x80000FFFFFFFFFFF,	0x8000100000000000,
	0x8000FFFFFFFFFFFF,	0x8001000000000000,	0x800FFFFFFFFFFFFF,	0x8010000000000000,	0x80FFFFFFFFFFFFFF,
	0x8100000000000000,	0x8FFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF };

	INT64 q[ARRAY_SIZE(p)] = { 0 };

	for (INT32 i = 0;i < ARRAY_SIZE(p);++i)
	{
		cs << p[i];
		cs >> q[i];

		CHECK_EQUAL(p[i] , q[i]); 
	}  
} 

TEST(CStream_UINT64)
{
	CUtil::CStream cs;
	UINT64 p[] = { 0x0000000000000000 , 0x000000000000000F, 0x0000000000000010,	0x00000000000000FF,
		0x0000000000000100,	0x0000000000000FFF,	0x0000000000001000,	0x000000000000FFFFF,0x0000000000010000,
		0x0000000000FFFFFF,	0x0000000000100000,	0x000000000FFFFFFF,	0x0000000010000000,	0x00000000FFFFFFFF,
		0x0000000100000000, 0x0000000FFFFFFFFF, 0x0000001000000000,	0x000000FFFFFFFFFF,	0x0000010000000000,
		0x00000FFFFFFFFFFF,	0x0000100000000000,	0x0000FFFFFFFFFFFF,	0x0001000000000000,	0x000FFFFFFFFFFFFF,
		0x0010000000000000,	0x00FFFFFFFFFFFFFF,	0x0100000000000000,	0x0FFFFFFFFFFFFFFF,	0x1000000000000000,
		0x7FFFFFFFFFFFFFFF, 0x8000000000000001,	0x800000000000000F,	0x8000000000000010,	0x80000000000000FF,
		0x8000000000000100,	0x8000000000000FFF,	0x8000000000001000,	0x80000000000FFFFF,	0x8000000000100000,
		0x8000000000FFFFFF,	0x8000000001000000,	0x800000000FFFFFFF,	0x8000000010000000, 0x80000000FFFFFFFF,
		0x8000001000000000,	0x800000FFFFFFFFFF,	0x8000010000000000,	0x80000FFFFFFFFFFF,	0x8000100000000000,
		0x8000FFFFFFFFFFFF,	0x8001000000000000,	0x800FFFFFFFFFFFFF,	0x8010000000000000,	0x80FFFFFFFFFFFFFF,
		0x8100000000000000,	0x8FFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF };

	UINT64 q[sizeof(ARRAY_SIZE(p))] = { 0 };

	for (INT32 i = 0;i < sizeof(ARRAY_SIZE(p));++i)
	{
		cs << p[i];
		cs >> q[i];

		CHECK_EQUAL(p[i] , q[i]); 
	} 
}  

TEST(CStream)
{
	CUtil::CStream cs; 
	
	const char t = 1;
	const UINT8 t1 = 2;
	const bool t2 = 1;
	const INT16 t3 = 4;
	const UINT16 t4 = 5;
	const INT32 t5 = 6;
	const UINT32 t6 = 7;
	const INT64 t7 = 8;
	const UINT64 t8 = 9;
	const float t9 = 10;
	const double t10 = 11;
	const CUtil::CharPtr  t11("12" , sizeof("12"));
	const std::string t12 = "13";
	const CUtil::CStream  t13("14" , sizeof("14")); 
	const CUtil::Chunk  t14(15);
	const std::vector<INT32> t15(1);
 	const std::vector<INT32> t16(1);
 	const std::list<INT32> t17(1);
	std::set<INT32> tempSet;
	tempSet.insert(1);
	const std::set<INT32> t18 = tempSet; 
	const std::string t19("t19");
	std::map<INT32 , INT32> tempMap;
	tempMap[1] = 2;
	const std::map<INT32 , INT32> t20 = tempMap;
	const std::pair<INT32 , INT32> t21;
	
	char p = 0;
	UINT8 p1 = 0;
	bool p2 = 0;
	INT16 p3 = 0;
	UINT16 p4 = 0;
	INT32 p5 = 0;
	UINT32 p6 = 0;
	INT64 p7 = 0;
	UINT64 p8 = 0;
	float p9 = 0;
	double p10 = 0;
	CUtil::CharPtr p11;
	std::string p12;
	CUtil::CStream  p13; 
	CUtil::Chunk  p14;
	std::vector<INT32> p15; 
 	std::vector<INT32> p16;
 	std::list<INT32> p17;
 	std::set<INT32> p18; 
	std::string p19;
	std::map<INT32 , INT32> p20;
	std::pair<INT32 , INT32> p21;


	cs << t << t1 << t2 << t3 << t4 << t5 << t6 << t7 << t8 << t9 << t10 << t11 << t12 << t13 << t14 << t15 << t16 << t17 << t18 << t19 << t20 << t21  ;
	cs >> p >> p1 >> p2 >> p3 >> p4 >> p5 >> p6 >> p7 >> p8 >> p9 >> p10 >> p11 >> p12 >> p13 >> p14 >> p15 >> p16 >> p17 >> p18 >> p19 >> p20 >> p21;//  ;

	CHECK_EQUAL(t , p);
	CHECK_EQUAL(t1 , p1);
	CHECK_EQUAL(t2 , p2);
	CHECK_EQUAL(t3 , p3);
	CHECK_EQUAL(t4 , p4);
	CHECK_EQUAL(t5 , p5);
	CHECK_EQUAL(t6 , p6);
	CHECK_EQUAL(t7 , p7);
	CHECK_EQUAL(t8 , p8);
	CHECK_EQUAL(t9 , p9);
	CHECK_EQUAL(t10 , p10);
//	CHECK_EQUAL(t11 , p11);
	CHECK_EQUAL(t12 , p12);
	CHECK_EQUAL(t13 , p13);
	CHECK_EQUAL(t14 , p14);
	Assert(t15 == p15);
 	Assert(t16 == p16);
	Assert(t17 == p17);
	Assert(t18 == p18);
	Assert(t19 == p19);
	Assert(t20 == p20);
	Assert(t21 == p21);
}  